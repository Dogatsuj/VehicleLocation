@page
@model VehiculeLocation.Frontend.Pages.AddModel
@{
    ViewData["Title"] = "Add a vehicle";
}
<link rel="stylesheet" href="~/css/addVehicle.css" asp-append-version="true" />
<section class="add-page">
    <h1 class="add-title">Add a rentable vehicle</h1>
    <form method="post" class="add-form">
        <div class="add-grid">
            <div class="add-column">
                <label for="brand">Brand</label>
                <input id="brand" name="brand" type="text" placeholder="Renault" asp-for="Vehicle.Brand" required />
                <span asp-validation-for="Vehicle.Brand" class="text-danger"></span>

                <label for="model">Model</label>
                <input id="model" name="model" type="text" placeholder="Clio" asp-for="Vehicle.Model" required />
                <span asp-validation-for="Vehicle.Model" class="text-danger"></span>

                <label for="seats">Seats</label>
                <input id="seats" name="seats" type="number" min="1" max="9" placeholder="5" asp-for="Vehicle.Seats" required />
                <span asp-validation-for="Vehicle.Seats" class="text-danger"></span>

                <label for="dailyRentalPrice">Daily Rental Price (€)</label>
                <input id="dailyRentalPrice" name="dailyRentalPrice" type="number" step="0.01" min="0" placeholder="50.00" asp-for="Vehicle.DailyRentalPrice" required />
                <span asp-validation-for="Vehicle.DailyRentalPrice" class="text-danger"></span>

                <label for="description">Description</label>
                <textarea id="description" name="description" rows="4" placeholder="Renault Clio from 2017, very good state ..." asp-for="Vehicle.Description"></textarea>
                <span asp-validation-for="Vehicle.Description" class="text-danger"></span>
            </div>
            <div class="add-column">
                <label for="motorisation">Motorisation</label>
                <div class="select-shell">
                    <select id="motorisation" name="motorisation" asp-for="Vehicle.Motorisation" required>
                        <option value="Petrol">Petrol</option>
                        <option value="Diesel">Diesel</option>
                        <option value="Hybrid">Hybrid</option>
                        <option value="Electric">Electric</option>
                    </select>
                    <span class="chevron" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6 9l6 6 6-6" />
                        </svg>
                    </span>
                </div>
                <span asp-validation-for="Vehicle.Motorisation" class="text-danger"></span>

                <label for="isAutomaticTransmission">Transmission</label>
                <div class="select-shell">
                    <select id="isAutomaticTransmission" name="isAutomaticTransmission" asp-for="Vehicle.IsAutomaticTransmission" required>
                        <option value="false">Manual</option>
                        <option value="true">Automatic</option>
                    </select>
                    <span class="chevron" aria-hidden="true">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6 9l6 6 6-6" />
                        </svg>
                    </span>
                </div>
                <span asp-validation-for="Vehicle.IsAutomaticTransmission" class="text-danger"></span>

                <label for="imagePath">Image URL</label>
                <input id="imagePath" name="imagePath" type="url" inputmode="url" placeholder="https://example.com/your-car.jpg" asp-for="Vehicle.ImagePath" />
                <span asp-validation-for="Vehicle.ImagePath" class="text-danger"></span>

                <label>Preview</label>
                <div class="preview-card">
                    <img id="previewImage"
                         src="@(string.IsNullOrWhiteSpace(Model.Vehicle?.ImagePath) ? "https://placehold.co/600x338?text=Vehicle+preview" : Model.Vehicle?.ImagePath)"
                         data-placeholder="https://placehold.co/600x338?text=Vehicle+preview"
                         alt="@(string.IsNullOrWhiteSpace(Model.Vehicle?.Brand) && string.IsNullOrWhiteSpace(Model.Vehicle?.Model) ? "Vehicle preview" : $"{Model.Vehicle?.Brand} {Model.Vehicle?.Model}")" />
                </div>
            </div>
        </div>
        <div class="add-actions">
            <button type="submit" class="cta-button">Add Vehicle</button>
        </div>
    </form>
</section>
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        (function () {
            const urlInput = document.getElementById('imagePath');
            const preview = document.getElementById('previewImage');
            const placeholder = preview?.dataset?.placeholder || '';
            const initial = preview?.getAttribute('src') || placeholder;
            if (urlInput && preview) {
                const update = () => {
                    const next = urlInput.value.trim();
                    preview.src = next || placeholder || initial;
                };
                if (!preview.getAttribute('src')) {
                    preview.src = placeholder || initial;
                }
                urlInput.addEventListener('input', update);
                urlInput.addEventListener('blur', update);
            }
        })();
    </script>
}
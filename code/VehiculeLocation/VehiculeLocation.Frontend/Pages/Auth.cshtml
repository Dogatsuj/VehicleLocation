@page "/Auth"
@model VehiculeLocation.Frontend.Pages.AuthModel
@{
    ViewData["Title"] = "Login / Sign Up";
}

<link rel="stylesheet" href="~/css/auth.css" asp-append-version="true" />

@{
    var activeTab = Model.ActiveTab ?? "login";
}

<section class="auth-page">
    <div class="auth-card">
        <div class="auth-header">
            <div>
                <p class="eyebrow">Customer Area</p>
                <h1>Login / Sign Up</h1>
                <p class="lede">Manage your bookings and your vehicles with ease.</p>
            </div>
        </div>

        <div class="auth-tabs" role="tablist">
            <button type="button" class="auth-tab @(activeTab == "login" ? "is-active" : "")" data-tab="login" role="tab" aria-selected="@(activeTab == "login")">Login</button>
            <button type="button" class="auth-tab @(activeTab == "signup" ? "is-active" : "")" data-tab="signup" role="tab" aria-selected="@(activeTab == "signup")">Sign Up</button>
        </div>

        <div class="auth-content">
            <form method="post" asp-page-handler="Login" class="auth-form @(activeTab == "login" ? "is-active" : "")" data-panel="login" aria-hidden="@(activeTab != "login")" novalidate>
                <label for="loginName">Name</label>
                <input id="loginName" name="LoginName" value="@Model.LoginName" type="text" autocomplete="username" placeholder="Your name" />

                <label for="loginPassword">Password</label>
                <input id="loginPassword" name="LoginPassword" type="password" autocomplete="current-password" placeholder="Your password" />

                <button type="submit" class="auth-submit">Login</button>

                @if (!string.IsNullOrWhiteSpace(Model.LoginMessage))
                {
                    <div class="auth-alert success">
                        <p>@Model.LoginMessage</p>
                    </div>
                }
            </form>

            <form method="post" asp-page-handler="Signup" class="auth-form @(activeTab == "signup" ? "is-active" : "")" data-panel="signup" aria-hidden="@(activeTab != "signup")" novalidate>
                <label for="signupName">Username</label>
                <input id="signupName" name="SignupName" value="@Model.SignupName" type="text" autocomplete="username" placeholder="Your username" />

                <label for="signupPassword">Password</label>
                <input id="signupPassword" name="SignupPassword" type="password" autocomplete="new-password" placeholder="Your password" />

                <label for="signupConfirm">Confirm password</label>
                <input id="signupConfirm" name="SignupConfirmPassword" type="password" autocomplete="new-password" placeholder="Repeat your password" />

                @if (!string.IsNullOrWhiteSpace(Model.SignupError))
                {
                    <div class="auth-alert error">@Model.SignupError</div>
                }

                @if (!string.IsNullOrWhiteSpace(Model.SignupMessage))
                {
                    <div class="auth-alert success">
                        <p>@Model.SignupMessage</p>
                    </div>
                }

                <button type="submit" class="auth-submit">Sign Up</button>
            </form>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        (() => {
            const tabs = document.querySelectorAll('.auth-tab');
            const panels = document.querySelectorAll('.auth-form[data-panel]');

            const setActive = (key) => {
                tabs.forEach(tab => {
                    const isActive = tab.dataset.tab === key;
                    tab.classList.toggle('is-active', isActive);
                    tab.setAttribute('aria-selected', isActive ? 'true' : 'false');
                });

                panels.forEach(panel => {
                    const isActive = panel.dataset.panel === key;
                    panel.classList.toggle('is-active', isActive);
                    panel.toggleAttribute('aria-hidden', !isActive);
                });
            };

            tabs.forEach(tab => tab.addEventListener('click', () => setActive(tab.dataset.tab)));
        })();
    </script>
}
